---
apiVersion: v1
kind: ConfigMap
metadata:
  name: truenas-graphite-mapping
  namespace: monitoring
data:
  graphite-mapping.yaml: |
    mappings:
      # TrueNAS disk operations
      - match: scale\.graphite\.server\.disk_qops\.(.+)\.operations
        name: truenas_disk_qops
        labels:
          disk: '$1'
    
      # TrueNAS disk temperatures
      - match: scale\.graphite\.server\.disk_temp\.(.+)\.temperature
        name: truenas_disk_temperature
        labels:
          disk: '$1'
    
      # TrueNAS disk bandwidth
      - match: scale\.graphite\.server\.disk_bandwidth\.(.+)\.(read|write)
        name: truenas_disk_bandwidth_${2}
        labels:
          disk: '$1'
    
      # TrueNAS network traffic
      - match: scale\.graphite\.server\.interface\.(.+)\.(if_octets\.rx|if_octets\.tx)
        name: truenas_network_${2}
        labels:
          interface: '$1'
    
      # TrueNAS ZFS pool stats
      - match: scale\.graphite\.server\.zfs\.(.+)\.(.+)
        name: truenas_zfs_${2}
        labels:
          pool: '$1'
    
      # TrueNAS CPU stats
      - match: scale\.graphite\.server\.cpu\.(.+)\.(.+)
        name: truenas_cpu_${2}
        labels:
          cpu: '$1'
    
      # TrueNAS memory stats
      - match: scale\.graphite\.server\.memory\.(.+)
        name: truenas_memory_${1}
    
      # TrueNAS uptime
      - match: scale\.graphite\.server\.uptime
        name: truenas_uptime
    
      # K3s pod stats
      - match: scale\.graphite\.server\.k3s_stats\.k3s_pod_stats\.(.+)\.(cpu|mem|net\.incoming|net\.outgoing)
        name: truenas_k3s_pod_${2}
        labels:
          pod: '$1'
